{"ast":null,"code":"import { eventScope, TouchRecord } from '../utils/';\nvar activeScrollbar;\nexport function touchHandler(scrollbar) {\n  var target = scrollbar.options.delegateTo || scrollbar.containerEl;\n  var touchRecord = new TouchRecord();\n  var addEvent = eventScope(scrollbar);\n  var damping;\n  var pointerCount = 0;\n  addEvent(target, 'touchstart', function (evt) {\n    // start records\n    touchRecord.track(evt); // stop scrolling\n\n    scrollbar.setMomentum(0, 0); // save damping\n\n    if (pointerCount === 0) {\n      damping = scrollbar.options.damping;\n      scrollbar.options.damping = Math.max(damping, 0.5); // less frames on touchmove\n    }\n\n    pointerCount++;\n  });\n  addEvent(target, 'touchmove', function (evt) {\n    if (activeScrollbar && activeScrollbar !== scrollbar) return;\n    touchRecord.update(evt);\n\n    var _a = touchRecord.getDelta(),\n        x = _a.x,\n        y = _a.y;\n\n    scrollbar.addTransformableMomentum(x, y, evt, function (willScroll) {\n      if (willScroll && evt.cancelable) {\n        evt.preventDefault();\n        activeScrollbar = scrollbar;\n      }\n    });\n  });\n  addEvent(target, 'touchcancel touchend', function (evt) {\n    var delta = touchRecord.getEasingDistance(damping);\n    scrollbar.addTransformableMomentum(delta.x, delta.y, evt);\n    pointerCount--; // restore damping\n\n    if (pointerCount === 0) {\n      scrollbar.options.damping = damping;\n    }\n\n    touchRecord.release(evt);\n    activeScrollbar = null;\n  });\n}","map":{"version":3,"mappings":"AAAA,SAASA,UAAT,EAAqBC,WAArB,QAAyC,WAAzC;AACA,IAAIC,eAAJ;AACA,OAAO,SAASC,YAAT,CAAsBC,SAAtB,EAAiC;AACpC,MAAIC,MAAM,GAAGD,SAAS,CAACE,OAAV,CAAkBC,UAAlB,IAAgCH,SAAS,CAACI,WAAvD;AACA,MAAIC,WAAW,GAAG,IAAIR,WAAJ,EAAlB;AACA,MAAIS,QAAQ,GAAGV,UAAU,CAACI,SAAD,CAAzB;AACA,MAAIO,OAAJ;AACA,MAAIC,YAAY,GAAG,CAAnB;AACAF,EAAAA,QAAQ,CAACL,MAAD,EAAS,YAAT,EAAuB,UAAUQ,GAAV,EAAe;AAC1C;AACAJ,IAAAA,WAAW,CAACK,KAAZ,CAAkBD,GAAlB,EAF0C,CAG1C;;AACAT,IAAAA,SAAS,CAACW,WAAV,CAAsB,CAAtB,EAAyB,CAAzB,EAJ0C,CAK1C;;AACA,QAAIH,YAAY,KAAK,CAArB,EAAwB;AACpBD,MAAAA,OAAO,GAAGP,SAAS,CAACE,OAAV,CAAkBK,OAA5B;AACAP,MAAAA,SAAS,CAACE,OAAV,CAAkBK,OAAlB,GAA4BK,IAAI,CAACC,GAAL,CAASN,OAAT,EAAkB,GAAlB,CAA5B,CAFoB,CAEgC;AACvD;;AACDC,IAAAA,YAAY;AACf,GAXO,CAAR;AAYAF,EAAAA,QAAQ,CAACL,MAAD,EAAS,WAAT,EAAsB,UAAUQ,GAAV,EAAe;AACzC,QAAIX,eAAe,IAAIA,eAAe,KAAKE,SAA3C,EACI;AACJK,IAAAA,WAAW,CAACS,MAAZ,CAAmBL,GAAnB;;AACA,QAAIM,EAAE,GAAGV,WAAW,CAACW,QAAZ,EAAT;AAAA,QAAiCC,CAAC,GAAGF,EAAE,CAACE,CAAxC;AAAA,QAA2CC,CAAC,GAAGH,EAAE,CAACG,CAAlD;;AACAlB,IAAAA,SAAS,CAACmB,wBAAV,CAAmCF,CAAnC,EAAsCC,CAAtC,EAAyCT,GAAzC,EAA8C,UAAUW,UAAV,EAAsB;AAChE,UAAIA,UAAU,IAAIX,GAAG,CAACY,UAAtB,EAAkC;AAC9BZ,QAAAA,GAAG,CAACa,cAAJ;AACAxB,QAAAA,eAAe,GAAGE,SAAlB;AACH;AACJ,KALD;AAMH,GAXO,CAAR;AAYAM,EAAAA,QAAQ,CAACL,MAAD,EAAS,sBAAT,EAAiC,UAAUQ,GAAV,EAAe;AACpD,QAAIc,KAAK,GAAGlB,WAAW,CAACmB,iBAAZ,CAA8BjB,OAA9B,CAAZ;AACAP,IAAAA,SAAS,CAACmB,wBAAV,CAAmCI,KAAK,CAACN,CAAzC,EAA4CM,KAAK,CAACL,CAAlD,EAAqDT,GAArD;AACAD,IAAAA,YAAY,GAHwC,CAIpD;;AACA,QAAIA,YAAY,KAAK,CAArB,EAAwB;AACpBR,MAAAA,SAAS,CAACE,OAAV,CAAkBK,OAAlB,GAA4BA,OAA5B;AACH;;AACDF,IAAAA,WAAW,CAACoB,OAAZ,CAAoBhB,GAApB;AACAX,IAAAA,eAAe,GAAG,IAAlB;AACH,GAVO,CAAR;AAWH","names":["eventScope","TouchRecord","activeScrollbar","touchHandler","scrollbar","target","options","delegateTo","containerEl","touchRecord","addEvent","damping","pointerCount","evt","track","setMomentum","Math","max","update","x","y","addTransformableMomentum","willScroll","cancelable","preventDefault","delta","getEasingDistance","release"],"sourceRoot":"","sources":["../src/events/touch.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}