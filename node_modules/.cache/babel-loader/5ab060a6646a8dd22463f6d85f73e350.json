{"ast":null,"code":"import clamp from 'lodash-es/clamp';\nimport { eventScope, getPosition } from '../utils/';\nexport function selectHandler(scrollbar) {\n  var addEvent = eventScope(scrollbar);\n  var containerEl = scrollbar.containerEl,\n      contentEl = scrollbar.contentEl;\n  var isSelected = false;\n  var animationID;\n\n  function scroll(_a) {\n    var x = _a.x,\n        y = _a.y;\n    if (!x && !y) return;\n    var offset = scrollbar.offset,\n        limit = scrollbar.limit; // DISALLOW delta transformation\n\n    scrollbar.setMomentum(clamp(offset.x + x, 0, limit.x) - offset.x, clamp(offset.y + y, 0, limit.y) - offset.y);\n    animationID = requestAnimationFrame(function () {\n      scroll({\n        x: x,\n        y: y\n      });\n    });\n  }\n\n  addEvent(window, 'mousemove', function (evt) {\n    if (!isSelected) return;\n    cancelAnimationFrame(animationID);\n    var dir = calcMomentum(scrollbar, evt);\n    scroll(dir);\n  });\n  addEvent(contentEl, 'selectstart', function (evt) {\n    evt.stopPropagation();\n    cancelAnimationFrame(animationID);\n    isSelected = true;\n  });\n  addEvent(window, 'mouseup blur', function () {\n    cancelAnimationFrame(animationID);\n    isSelected = false;\n  }); // patch for touch devices\n\n  addEvent(containerEl, 'scroll', function (evt) {\n    evt.preventDefault();\n    containerEl.scrollTop = containerEl.scrollLeft = 0;\n  });\n}\n\nfunction calcMomentum(scrollbar, evt) {\n  var _a = scrollbar.bounding,\n      top = _a.top,\n      right = _a.right,\n      bottom = _a.bottom,\n      left = _a.left;\n\n  var _b = getPosition(evt),\n      x = _b.x,\n      y = _b.y;\n\n  var res = {\n    x: 0,\n    y: 0\n  };\n  var padding = 20;\n  if (x === 0 && y === 0) return res;\n\n  if (x > right - padding) {\n    res.x = x - right + padding;\n  } else if (x < left + padding) {\n    res.x = x - left - padding;\n  }\n\n  if (y > bottom - padding) {\n    res.y = y - bottom + padding;\n  } else if (y < top + padding) {\n    res.y = y - top - padding;\n  }\n\n  res.x *= 2;\n  res.y *= 2;\n  return res;\n}","map":{"version":3,"mappings":"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","names":["clamp","eventScope","getPosition","selectHandler","scrollbar","addEvent","contentEl","isSelected","animationID","scroll","_a","x","y","limit","setMomentum","offset","requestAnimationFrame","window","evt","cancelAnimationFrame","dir","calcMomentum","stopPropagation","containerEl","preventDefault","scrollTop","scrollLeft","top","right","bottom","left","res","padding"],"sourceRoot":"","sources":["../src/events/select.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}