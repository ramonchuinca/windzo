{"ast":null,"code":"import clamp from 'lodash-es/clamp';\nimport { isOneOf, getPosition, eventScope, setStyle } from '../utils/';\nvar Direction;\n\n(function (Direction) {\n  Direction[Direction[\"X\"] = 0] = \"X\";\n  Direction[Direction[\"Y\"] = 1] = \"Y\";\n})(Direction || (Direction = {}));\n\nexport function mouseHandler(scrollbar) {\n  var addEvent = eventScope(scrollbar);\n  var container = scrollbar.containerEl;\n  var _a = scrollbar.track,\n      xAxis = _a.xAxis,\n      yAxis = _a.yAxis;\n\n  function calcMomentum(direction, clickPosition) {\n    var size = scrollbar.size,\n        limit = scrollbar.limit,\n        offset = scrollbar.offset;\n\n    if (direction === Direction.X) {\n      var totalWidth = size.container.width + (xAxis.thumb.realSize - xAxis.thumb.displaySize);\n      return clamp(clickPosition / totalWidth * size.content.width, 0, limit.x) - offset.x;\n    }\n\n    if (direction === Direction.Y) {\n      var totalHeight = size.container.height + (yAxis.thumb.realSize - yAxis.thumb.displaySize);\n      return clamp(clickPosition / totalHeight * size.content.height, 0, limit.y) - offset.y;\n    }\n\n    return 0;\n  }\n\n  function getTrackDirection(elem) {\n    if (isOneOf(elem, [xAxis.element, xAxis.thumb.element])) {\n      return Direction.X;\n    }\n\n    if (isOneOf(elem, [yAxis.element, yAxis.thumb.element])) {\n      return Direction.Y;\n    }\n\n    return void 0;\n  }\n\n  var isMouseDown;\n  var isMouseMoving;\n  var startOffsetToThumb;\n  var trackDirection;\n  var containerRect;\n  addEvent(container, 'click', function (evt) {\n    if (isMouseMoving || !isOneOf(evt.target, [xAxis.element, yAxis.element])) {\n      return;\n    }\n\n    var track = evt.target;\n    var direction = getTrackDirection(track);\n    var rect = track.getBoundingClientRect();\n    var clickPos = getPosition(evt);\n\n    if (direction === Direction.X) {\n      var offsetOnTrack = clickPos.x - rect.left - xAxis.thumb.displaySize / 2;\n      scrollbar.setMomentum(calcMomentum(direction, offsetOnTrack), 0);\n    }\n\n    if (direction === Direction.Y) {\n      var offsetOnTrack = clickPos.y - rect.top - yAxis.thumb.displaySize / 2;\n      scrollbar.setMomentum(0, calcMomentum(direction, offsetOnTrack));\n    }\n  });\n  addEvent(container, 'mousedown', function (evt) {\n    if (!isOneOf(evt.target, [xAxis.thumb.element, yAxis.thumb.element])) {\n      return;\n    }\n\n    isMouseDown = true;\n    var thumb = evt.target;\n    var cursorPos = getPosition(evt);\n    var thumbRect = thumb.getBoundingClientRect();\n    trackDirection = getTrackDirection(thumb); // pointer offset to thumb\n\n    startOffsetToThumb = {\n      x: cursorPos.x - thumbRect.left,\n      y: cursorPos.y - thumbRect.top\n    }; // container bounding rectangle\n\n    containerRect = container.getBoundingClientRect(); // prevent selection, see:\n    // https://github.com/idiotWu/smooth-scrollbar/issues/48\n\n    setStyle(scrollbar.containerEl, {\n      '-user-select': 'none'\n    });\n  });\n  addEvent(window, 'mousemove', function (evt) {\n    if (!isMouseDown) return;\n    isMouseMoving = true;\n    var cursorPos = getPosition(evt);\n\n    if (trackDirection === Direction.X) {\n      // get percentage of pointer position in track\n      // then tranform to px\n      // don't need easing\n      var offsetOnTrack = cursorPos.x - startOffsetToThumb.x - containerRect.left;\n      scrollbar.setMomentum(calcMomentum(trackDirection, offsetOnTrack), 0);\n    }\n\n    if (trackDirection === Direction.Y) {\n      var offsetOnTrack = cursorPos.y - startOffsetToThumb.y - containerRect.top;\n      scrollbar.setMomentum(0, calcMomentum(trackDirection, offsetOnTrack));\n    }\n  });\n  addEvent(window, 'mouseup blur', function () {\n    isMouseDown = isMouseMoving = false;\n    setStyle(scrollbar.containerEl, {\n      '-user-select': ''\n    });\n  });\n}","map":{"version":3,"mappings":"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","names":["clamp","isOneOf","getPosition","eventScope","setStyle","Direction","mouseHandler","scrollbar","addEvent","container","containerEl","xAxis","yAxis","calcMomentum","direction","clickPosition","limit","offset","X","totalWidth","size","width","thumb","realSize","displaySize","content","x","Y","totalHeight","height","y","getTrackDirection","elem","element","isMouseDown","isMouseMoving","startOffsetToThumb","trackDirection","containerRect","evt","target","track","rect","getBoundingClientRect","clickPos","offsetOnTrack","left","setMomentum","top","cursorPos","thumbRect","window"],"sourceRoot":"","sources":["../src/events/mouse.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}